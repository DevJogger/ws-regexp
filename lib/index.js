"use strict";
/**
 * Created by user on 2018/4/26/026.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const flags_1 = require("./flags");
exports.FlagsName = flags_1.default;
/**
 * Check whether a RegExp flag is supported
 */
function hasSupportFlag(flag, RegExpClass = RegExp, skipPatternCheck) {
    if (!flag || typeof flag != 'string' || flag.length != 1) {
        throw new TypeError(`"${flag}" not a valid flag`);
    }
    let isSupported = null;
    try {
        if (!skipPatternCheck && flags_1.FlagsPattern[flag]) {
            isSupported = testFlag(flag, RegExpClass);
        }
        else {
            new RegExpClass('', flag);
            isSupported = true;
        }
    }
    catch (exception) {
        isSupported = false;
    }
    return isSupported;
}
exports.hasSupportFlag = hasSupportFlag;
function testFlag(flag, 
// @ts-ignore
RegExpClass = RegExp, testPattern = flags_1.FlagsPattern) {
    if (testPattern[flag] && testPattern[flag].length) {
        return testPattern[flag].every(function (v) {
            let [pattern, input, value, fn] = v;
            let bool;
            let r = createRegExp(pattern, flag, RegExpClass);
            if (fn) {
                if (typeof fn == 'function') {
                    bool = fn(r, value, input, pattern, RegExpClass, flag);
                }
                else {
                    bool = r[fn](input) === value;
                }
            }
            else {
                bool = r.test(input) === value;
            }
            return bool;
        }) === true;
    }
    return false;
}
exports.testFlag = testFlag;
const self = require("./index");
exports.default = self;
function testFlagsAll(RegExpClass = RegExp, skipPatternCheck) {
    let flagsAll = {};
    for (let i = 65; i <= 90; i++) {
        let k1 = String.fromCharCode(i);
        let k2 = String.fromCharCode(i + 32);
        flagsAll[k1] = hasSupportFlag(k1, RegExpClass, skipPatternCheck);
        flagsAll[k2] = hasSupportFlag(k2, RegExpClass, skipPatternCheck);
    }
    let def = [
        'g',
        'i',
        'm',
        's',
        'u',
        'y',
    ];
    flagsAll = Object.keys(flagsAll).sort().reduce(function (a, flag) {
        if (flagsAll[flag] || def.includes(flag)) {
            a[flag] = flagsAll[flag];
        }
        return a;
    }, {});
    return flagsAll;
}
exports.testFlagsAll = testFlagsAll;
// @ts-ignore
function createRegExp(pattern, flag, RegExpClass = RegExp) {
    let r;
    if (typeof RegExpClass.create == 'function') {
        r = RegExpClass.create(pattern, flag);
    }
    else {
        r = new RegExpClass(pattern, flag);
    }
    return r;
}
exports.createRegExp = createRegExp;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7O0dBRUc7O0FBRUgsbUNBQXVFO0FBRTlELG9CQUZGLGVBQVMsQ0FFRTtBQUlsQjs7R0FFRztBQUNILFNBQWdCLGNBQWMsQ0FBQyxJQUFZLEVBQUUsY0FBNkIsTUFBTSxFQUFFLGdCQUEwQjtJQUUzRyxJQUFJLENBQUMsSUFBSSxJQUFJLE9BQU8sSUFBSSxJQUFJLFFBQVEsSUFBSSxJQUFJLENBQUMsTUFBTSxJQUFJLENBQUMsRUFDeEQ7UUFDQyxNQUFNLElBQUksU0FBUyxDQUFDLElBQUksSUFBSSxvQkFBb0IsQ0FBQyxDQUFBO0tBQ2pEO0lBRUQsSUFBSSxXQUFXLEdBQVksSUFBSSxDQUFDO0lBQ2hDLElBQ0E7UUFDQyxJQUFJLENBQUMsZ0JBQWdCLElBQUksb0JBQVksQ0FBQyxJQUFJLENBQUMsRUFDM0M7WUFDQyxXQUFXLEdBQUcsUUFBUSxDQUFDLElBQUksRUFBRSxXQUFXLENBQUMsQ0FBQztTQUMxQzthQUVEO1lBQ0MsSUFBSSxXQUFXLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQyxDQUFDO1lBQzFCLFdBQVcsR0FBRyxJQUFJLENBQUM7U0FDbkI7S0FDRDtJQUNELE9BQU8sU0FBUyxFQUNoQjtRQUNDLFdBQVcsR0FBRyxLQUFLLENBQUM7S0FDcEI7SUFDRCxPQUFPLFdBQVcsQ0FBQztBQUNwQixDQUFDO0FBekJELHdDQXlCQztBQUlELFNBQWdCLFFBQVEsQ0FBSSxJQUFZO0FBQ3ZDLGFBQWE7QUFDYixjQUFvQyxNQUFNLEVBQzFDLFdBQVcsR0FBRyxvQkFBWTtJQUcxQixJQUFJLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxFQUNqRDtRQUNDLE9BQU8sV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUM7WUFFekMsSUFBSSxDQUFDLE9B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Ki9cblxuaW1wb3J0IEZsYWdzTmFtZSwgeyBGbGFnc1BhdHRlcm4sIElGbGFnc1BhdHRlcm5UZXN0Rm4gfSBmcm9tICcuL2ZsYWdzJztcblxuZXhwb3J0IHsgRmxhZ3NOYW1lIH1cblxudHlwZSB2YWx1ZW9mPFQ+ID0gVFtrZXlvZiBUXTtcblxuLyoqXG4gKiBDaGVjayB3aGV0aGVyIGEgUmVnRXhwIGZsYWcgaXMgc3VwcG9ydGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBoYXNTdXBwb3J0RmxhZyhmbGFnOiBzdHJpbmcsIFJlZ0V4cENsYXNzOiB0eXBlb2YgUmVnRXhwID0gUmVnRXhwLCBza2lwUGF0dGVybkNoZWNrPzogYm9vbGVhbilcbntcblx0aWYgKCFmbGFnIHx8IHR5cGVvZiBmbGFnICE9ICdzdHJpbmcnIHx8IGZsYWcubGVuZ3RoICE9IDEpXG5cdHtcblx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKGBcIiR7ZmxhZ31cIiBub3QgYSB2YWxpZCBmbGFnYClcblx0fVxuXG5cdGxldCBpc1N1cHBvcnRlZDogYm9vbGVhbiA9IG51bGw7XG5cdHRyeVxuXHR7XG5cdFx0aWYgKCFza2lwUGF0dGVybkNoZWNrICYmIEZsYWdzUGF0dGVybltmbGFnXSlcblx0XHR7XG5cdFx0XHRpc1N1cHBvcnRlZCA9IHRlc3RGbGFnKGZsYWcsIFJlZ0V4cENsYXNzKTtcblx0XHR9XG5cdFx0ZWxzZVxuXHRcdHtcblx0XHRcdG5ldyBSZWdFeHBDbGFzcygnJywgZmxhZyk7XG5cdFx0XHRpc1N1cHBvcnRlZCA9IHRydWU7XG5cdFx0fVxuXHR9XG5cdGNhdGNoIChleGNlcHRpb24pXG5cdHtcblx0XHRpc1N1cHBvcnRlZCA9IGZhbHNlO1xuXHR9XG5cdHJldHVybiBpc1N1cHBvcnRlZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRlc3RGbGFnKGZsYWc6IHN0cmluZywgUmVnRXhwQ2xhc3M/OiB0eXBlb2YgUmVnRXhwLCB0ZXN0UGF0dGVybj86IHR5cGVvZiBGbGFnc1BhdHRlcm4pOiBib29sZWFuXG5leHBvcnQgZnVuY3Rpb24gdGVzdEZsYWcoZmxhZzogc3RyaW5nLCBSZWdFeHBDbGFzcz86IElDcmVhdGVSZWdFeHAsIHRlc3RQYXR0ZXJuPzogdHlwZW9mIEZsYWdzUGF0dGVybik6IGJvb2xlYW5cbmV4cG9ydCBmdW5jdGlvbiB0ZXN0RmxhZzxUPihmbGFnOiBzdHJpbmcsXG5cdC8vIEB0cy1pZ25vcmVcblx0UmVnRXhwQ2xhc3M6IElUeXBlQ3JlYXRlUmVnRXhwPFQ+ID0gUmVnRXhwLFxuXHR0ZXN0UGF0dGVybiA9IEZsYWdzUGF0dGVyblxuKTogYm9vbGVhblxue1xuXHRpZiAodGVzdFBhdHRlcm5bZmxhZ10gJiYgdGVzdFBhdHRlcm5bZmxhZ10ubGVuZ3RoKVxuXHR7XG5cdFx0cmV0dXJuIHRlc3RQYXR0ZXJuW2ZsYWddLmV2ZXJ5KGZ1bmN0aW9uICh2KVxuXHRcdHtcblx0XHRcdGxldCBbcGF0dGVybiwgaW5wdXQsIHZhbHVlLCBmbl0gPSB2O1xuXHRcdFx0bGV0IGJvb2w6IGJvb2xlYW47XG5cblx0XHRcdGxldCByID0gY3JlYXRlUmVnRXhwKHBhdHRlcm4sIGZsYWcsIFJlZ0V4cENsYXNzKTtcblxuXHRcdFx0aWYgKGZuKVxuXHRcdFx0e1xuXHRcdFx0XHRpZiAodHlwZW9mIGZuID09ICdmdW5jdGlvbicpXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRib29sID0gKGZuIGFzIElGbGFnc1BhdHRlcm5UZXN0Rm4pKHIsIHZhbHVlLCBpbnB1dCwgcGF0dGVybiwgUmVnRXhwQ2xhc3MsIGZsYWcpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0e1xuXHRcdFx0XHRcdGJvb2wgPSByW2ZuXShpbnB1dCkgPT09IHZhbHVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdGJvb2wgPSByLnRlc3QoaW5wdXQpID09PSB2YWx1ZTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGJvb2w7XG5cdFx0fSkgPT09IHRydWU7XG5cdH1cblxuXHRyZXR1cm4gZmFsc2U7XG59XG5cbmltcG9ydCAqIGFzIHNlbGYgZnJvbSAnLi9pbmRleCc7XG5pbXBvcnQgeyBQYXR0ZXJuVGVzdCB9IGZyb20gJy4vcGF0dGVybic7XG5cbmV4cG9ydCBkZWZhdWx0IHNlbGY7XG5cbmV4cG9ydCBmdW5jdGlvbiB0ZXN0RmxhZ3NBbGwoUmVnRXhwQ2xhc3M6IHR5cGVvZiBSZWdFeHAgPSBSZWdFeHAsIHNraXBQYXR0ZXJuQ2hlY2s/OiBib29sZWFuKToge1xuXHRnOiBib29sZWFuLFxuXHRpOiBib29sZWFuLFxuXHRtOiBib29sZWFuLFxuXHRzOiBib29sZWFuLFxuXHR1OiBib29sZWFuLFxuXHR5OiBib29sZWFuLFxuXG5cdFtrZXk6IHN0cmluZ106IGJvb2xlYW5cbn1cbntcblx0bGV0IGZsYWdzQWxsID0ge30gYXMgSUZsYWdzQWxsO1xuXG5cdGZvciAobGV0IGkgPSA2NTsgaSA8PSA5MDsgaSsrKVxuXHR7XG5cdFx0bGV0IGsxID0gU3RyaW5nLmZyb21DaGFyQ29kZShpKTtcblx0XHRsZXQgazIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGkgKyAzMik7XG5cblx0XHRmbGFnc0FsbFtrMV0gPSBoYXNTdXBwb3J0RmxhZyhrMSwgUmVnRXhwQ2xhc3MsIHNraXBQYXR0ZXJuQ2hlY2spO1xuXG5cdFx0ZmxhZ3NBbGxbazJdID0gaGFzU3VwcG9ydEZsYWcoazIsIFJlZ0V4cENsYXNzLCBza2lwUGF0dGVybkNoZWNrKTtcblx0fVxuXG5cdGxldCBkZWYgPSBbXG5cdFx0J2cnLFxuXHRcdCdpJyxcblx0XHQnbScsXG5cdFx0J3MnLFxuXHRcdCd1Jyxcblx0XHQneScsXG5cdF07XG5cblx0ZmxhZ3NBbGwgPSBPYmplY3Qua2V5cyhmbGFnc0FsbCkuc29ydCgpLnJlZHVjZShmdW5jdGlvbiAoYSwgZmxhZylcblx0e1xuXHRcdGlmIChmbGFnc0FsbFtmbGFnXSB8fCBkZWYuaW5jbHVkZXMoZmxhZykpXG5cdFx0e1xuXHRcdFx0YVtmbGFnXSA9IGZsYWdzQWxsW2ZsYWddO1xuXHRcdH1cblxuXHRcdHJldHVybiBhO1xuXHR9LCB7fSBhcyBJRmxhZ3NBbGwpO1xuXG5cdHJldHVybiBmbGFnc0FsbDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJRmxhZ3NBbGxcbntcblx0ZzogYm9vbGVhbixcblx0aTogYm9vbGVhbixcblx0bTogYm9vbGVhbixcblx0czogYm9vbGVhbixcblx0dTogYm9vbGVhbixcblx0eTogYm9vbGVhbixcblxuXHRba2V5OiBzdHJpbmddOiBib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUNyZWF0ZVJlZ0V4cFxue1xuXHRjcmVhdGU/KHBhdHRlcm4sIGZsYWcpXG5cblx0Y3JlYXRlPyhwYXR0ZXJuLCBmbGFnPylcblxuXHRjcmVhdGU/KHBhdHRlcm4sIGZsYWc/LCAuLi5hcmd2KVxufVxuXG5leHBvcnQgdHlwZSBJVHlwZUNyZWF0ZVJlZ0V4cDxUPiA9XG5cdFQgZXh0ZW5kcyB0eXBlb2YgUmVnRXhwID8gdHlwZW9mIFJlZ0V4cCA6XG5cdFx0VCBleHRlbmRzIElDcmVhdGVSZWdFeHAgPyBJQ3JlYXRlUmVnRXhwIDpcblx0XHRcdC8vVCBleHRlbmRzIFJlZ0V4cENvbnN0cnVjdG9yID8gUmVnRXhwQ29uc3RydWN0b3IgOlxuXHRcdFx0YW55XG5cdDtcblxuLy8gQHRzLWlnbm9yZVxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVJlZ0V4cDxUPihwYXR0ZXJuOiBzdHJpbmcsIGZsYWc/OiBzdHJpbmcsIFJlZ0V4cENsYXNzOiBJVHlwZUNyZWF0ZVJlZ0V4cDxUPiA9IFJlZ0V4cClcbntcblx0bGV0IHI6IFJlZ0V4cDtcblxuXHRpZiAodHlwZW9mICg8SUNyZWF0ZVJlZ0V4cD5SZWdFeHBDbGFzcykuY3JlYXRlID09ICdmdW5jdGlvbicpXG5cdHtcblx0XHRyID0gKDxJQ3JlYXRlUmVnRXhwPlJlZ0V4cENsYXNzKS5jcmVhdGUocGF0dGVybiwgZmxhZyk7XG5cdH1cblx0ZWxzZVxuXHR7XG5cdFx0ciA9IG5ldyAoPHR5cGVvZiBSZWdFeHA+UmVnRXhwQ2xhc3MpKHBhdHRlcm4sIGZsYWcpO1xuXHR9XG5cblx0cmV0dXJuIHI7XG59XG4iXX0=