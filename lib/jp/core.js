"use strict";
/**
 * Created by user on 2017/12/24/024.
 *
 * this module only do the char is exists in jp, zht, zhs
 * so don't use this module when u wanna fully zht <=> zhs
 *
 * 目前只支援 簡繁日漢字 並非全 cjk 漢字支援
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports._getdata = exports.init = exports.cjk2zhs = exports.cjk2zht = exports.cjk2jp = exports.zh2jp = exports.zhs2zht = exports.zht2zhs = exports.zht2jp = exports.zhs2jp = exports.jp2zhs = exports.jp2zht = exports.defaultOptions = exports.TABLE_SAFE = exports.TABLE = exports.KEY_ZHS = exports.KEY_ZHT = exports.KEY_JP = exports.ZHJP_TABLE_SAFE = exports.ZHJP_TABLE = void 0;
const util_1 = require("../util");
const table_1 = require("./table");
exports.ZHJP_TABLE = table_1.default;
Object.defineProperty(exports, "ZHJP_TABLE_SAFE", { enumerable: true, get: function () { return table_1.TABLE_SAFE; } });
const cjk_conv_1 = require("regexp-helper/lib/cjk-conv");
exports.KEY_JP = 'jp';
exports.KEY_ZHT = 'zht';
exports.KEY_ZHS = 'zhs';
let inited = false;
exports.defaultOptions = {
    safe: true,
};
// /[\u4E00-\u9FFF\u{20000}-\u{2FA1F}]+/u
const REGEXP_TEST = new RegExp(cjk_conv_1._re_cjk_conv('u').source + '+', 'u');
var _;
(function (_) {
    init();
    let langs = Object.keys(exports.TABLE);
    langs.forEach(function (from) {
        langs.forEach(function (to) {
            if (from == to)
                return;
            _[`${from}2${to}`] = function (str, options) {
                if (!REGEXP_TEST.test(str.toString())) {
                    return str;
                }
                options = Object.assign({}, exports.defaultOptions, options);
                return util_1.split(str)
                    .map(function (char) {
                    if (options.skip && options.skip.indexOf(char) != -1) {
                        return char;
                    }
                    let c;
                    if (c = _getdata(char, from, to, options.safe)) {
                        return c;
                    }
                    return char;
                })
                    .join('');
            };
        });
    });
})(_ || (_ = {}));
/**
 * only 只將 日文漢字 => 轉為繁漢字
 * @type {IFrom2To}
 */
exports.jp2zht = _.jp2zht;
/**
 * only 只將 日文漢字 => 轉為簡漢字
 * @type {IFrom2To}
 */
exports.jp2zhs = _.jp2zhs;
/**
 * only 簡漢字 => 轉為日漢字
 * @type {IFrom2To}
 */
exports.zhs2jp = _.zhs2jp;
/**
 * only 只將 繁漢字 => 轉為日文漢字
 * @type {IFrom2To}
 */
exports.zht2jp = _.zht2jp;
/**
 * only 只將簡繁日 當中共通的 繁漢字 => 轉為簡漢字
 * 請勿作為簡繁轉換用
 * @type {IFrom2To}
 */
exports.zht2zhs = _.zht2zhs;
/**
 * only 只將簡繁日 當中共通的 簡漢字 => 轉為繁漢字
 * 請勿作為簡繁轉換用
 * @type {IFrom2To}
 */
exports.zhs2zht = _.zhs2zht;
/**
 * only 只將簡繁日 當中共通的 簡繁漢字 => 轉為日文漢字
 *
 * @alias cjk2jp
 *
 * @param str
 * @param {IOptions} options
 * @returns {string}
 */
function zh2jp(str, options) {
    if (!REGEXP_TEST.test(str.toString())) {
        return str;
    }
    options = Object.assign({}, exports.defaultOptions, options);
    return util_1.split(str)
        .map(function (char) {
        if (options.skip && options.skip.indexOf(char) != -1) {
            return char;
        }
        let c;
        if (c = _getdata(char, exports.KEY_ZHT, exports.KEY_JP, options.safe)) {
            return c;
        }
        else if (c = _getdata(char, exports.KEY_ZHS, exports.KEY_JP, options.safe)) {
            return c;
        }
        return char;
    })
        .join('');
}
exports.zh2jp = zh2jp;
/**
 * only 只將簡繁日 當中共通的 簡繁漢字 => 轉為日文漢字
 *
 * @alias zh2jp
 *
 * @param str
 * @param {IOptions} options
 * @returns {string}
 */
exports.cjk2jp = zh2jp;
/**
 * only 只將簡繁日 當中共通的 漢字 => 轉為繁體漢字
 * 請勿作為簡繁轉換用
 *
 * @param str
 * @param {IOptions} options
 * @returns {string}
 */
function cjk2zht(str, options) {
    if (!REGEXP_TEST.test(str.toString())) {
        return str;
    }
    options = Object.assign({}, exports.defaultOptions, options);
    return util_1.split(str)
        .map(function (char) {
        if (options.skip && options.skip.indexOf(char) != -1) {
            return char;
        }
        let c;
        if (c = _getdata(char, exports.KEY_JP, exports.KEY_ZHT, options.safe)) {
            return c;
        }
        else if (c = _getdata(char, exports.KEY_ZHS, exports.KEY_ZHT, options.safe)) {
            return c;
        }
        return char;
    })
        .join('');
}
exports.cjk2zht = cjk2zht;
/**
 * only 只將簡繁日 當中共通的 漢字 => 轉為簡體漢字
 * 請勿作為簡繁轉換用
 *
 * @param str
 * @param {IOptions} options
 * @returns {string}
 */
function cjk2zhs(str, options) {
    if (!REGEXP_TEST.test(str.toString())) {
        return str;
    }
    options = Object.assign({}, exports.defaultOptions, options);
    return util_1.split(str)
        .map(function (char) {
        if (options.skip && options.skip.indexOf(char) != -1) {
            return char;
        }
        let c;
        if (c = _getdata(char, exports.KEY_JP, exports.KEY_ZHS, options.safe)) {
            return c;
        }
        else if (c = _getdata(char, exports.KEY_ZHT, exports.KEY_ZHS, options.safe)) {
            return c;
        }
        return char;
    })
        .join('');
}
exports.cjk2zhs = cjk2zhs;
//import * as fs from 'fs-extra';
//fs.outputJSON('./teachKanjiComparison.cache.json', TABLE, {
//	spaces: "\t",
//});
//fs.outputJSON('./teachKanjiComparison.cache2.json', TABLE_SAFE, {
//	spaces: "\t",
//});
//
//console.log(zhs2jp(1));
//
//let t = '魔物解説　ランク等話　蚀蝕蝕王で触王 冒険者ギルド解説 蚀|蝕战|戦马|馬亚|亞國預中日漢字對照表'
//
//console.log(zh2jp(t));
//console.log(zht2jp(t));
//console.log(zhs2jp(t));
//
//console.log(zht2zhs(t));
//console.log(zhs2zht(t));
function init(overwrite) {
    if (inited && !overwrite) {
        return exports.TABLE;
    }
    exports.TABLE = _(table_1.default);
    exports.TABLE_SAFE = _(table_1.TABLE_SAFE);
    function _(src) {
        let to = {};
        to[exports.KEY_JP] = {};
        to[exports.KEY_ZHT] = {};
        to[exports.KEY_ZHS] = {};
        src.forEach(function (vrow) {
            let [jp, zht, zhs] = vrow;
            let k = exports.KEY_JP;
            for (let c of jp) {
                if (!c || to[k][c]) {
                    continue;
                }
                to[k][c] = to[k][c] || {};
                to[k][c][k] = c;
                to[k][c][exports.KEY_ZHT] = zht[0];
                to[k][c][exports.KEY_ZHS] = zhs[0];
            }
            k = exports.KEY_ZHT;
            for (let c of zht) {
                if (!c || to[k][c]) {
                    continue;
                }
                to[k][c] = to[k][c] || {};
                to[k][c][exports.KEY_JP] = jp[0];
                to[k][c][k] = c;
                to[k][c][exports.KEY_ZHS] = zhs[0];
            }
            k = exports.KEY_ZHS;
            for (let c of zhs) {
                if (!c || to[k][c]) {
                    continue;
                }
                to[k][c] = to[k][c] || {};
                to[k][c][exports.KEY_JP] = jp[0];
                to[k][c][exports.KEY_ZHT] = zht[0];
                to[k][c][k] = c;
            }
        });
        // @ts-ignore
        return to;
    }
    inited = true;
    return exports.TABLE;
}
exports.init = init;
function _getdata(char, from, to, safe) {
    if (safe) {
        return (exports.TABLE_SAFE[from][char]) ? exports.TABLE_SAFE[from][char][to] : null;
    }
    return (exports.TABLE[from][char]) ? exports.TABLE[from][char][to] : null;
}
exports._getdata = _getdata;
exports.default = exports;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29yZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImNvcmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7O0dBT0c7OztBQUVILGtDQUFnQztBQUNoQyxtQ0FBb0U7QUFHM0QscUJBSEYsZUFBVSxDQUdFO0FBQUUsZ0dBSGMsa0JBQWUsT0FHZDtBQUZwQyx5REFBMEQ7QUFJN0MsUUFBQSxNQUFNLEdBQUcsSUFBSSxDQUFDO0FBQ2QsUUFBQSxPQUFPLEdBQUcsS0FBSyxDQUFDO0FBQ2hCLFFBQUEsT0FBTyxHQUFHLEtBQUssQ0FBQztBQUk3QixJQUFJLE1BQU0sR0FBRyxLQUFLLENBQUM7QUFxQ04sUUFBQSxjQUFjLEdBQWE7SUFDdkMsSUFBSSxFQUFFLElBQUk7Q0FDVixDQUFDO0FBRUYseUNBQXlDO0FBQ3pDLE1BQU0sV0FBVyxHQUFHLElBQUksTUFBTSxDQUFDLHVCQUFZLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxHQUFHLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQztBQUVwRSxJQUFVLENBQUMsQ0FpRFY7QUFqREQsV0FBVSxDQUFDO0lBRVYsSUFBSSxFQUFFLENBQUM7SUFTUCxJQUFJLEtBQUssR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLGFBQUssQ0FBQyxDQUFDO0lBRS9CLEtBQUssQ0FBQyxPQUFPLENBQUMsVUFBVSxJQUFrQjtRQUV6QyxLQUFLLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBZ0I7WUFFdkMsSUFBSSxJQUFJLElBQUksRUFBRTtnQkFBRSxPQUFPO1lBRXZCLENBQUMsQ0FBQyxHQUFHLElBQUksSUFBSSxFQUFFLEVBQUUsQ0FBQyxHQUFHLFVBQVUsR0FBRyxFQUFFLE9BQWtCO2dCQUVyRCxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLENBQUMsRUFDckM7b0JBQ0MsT0FBTyxHQUFHLENBQUM7aUJBQ1g7Z0JBRUQsT0FBTyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENB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T0FBTyxDQUFDLGtCQUFVLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsa0JBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0tBQ3BFO0lBRUQsT0FBTyxDQUFDLGFBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztBQUMzRCxDQUFDO0FBUkQsNEJBUUM7QUFPRCxrQkFBZSxPQUFrQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDcmVhdGVkIGJ5IHVzZXIgb24gMjAxNy8xMi8yNC8wMjQuXG4gKlxuICogdGhpcyBtb2R1bGUgb25seSBkbyB0aGUgY2hhciBpcyBleGlzdHMgaW4ganAsIHpodCwgemhzXG4gKiBzbyBkb24ndCB1c2UgdGhpcyBtb2R1bGUgd2hlbiB1IHdhbm5hIGZ1bGx5IHpodCA8PT4gemhzXG4gKlxuICog55uu5YmN5Y+q5pSv5o+0IOewoee5geaXpea8ouWtlyDkuKbpnZ7lhaggY2prIOa8ouWtl+aUr+aPtFxuICovXG5cbmltcG9ydCB7IHNwbGl0IH0gZnJvbSAnLi4vdXRpbCc7XG5pbXBvcnQgWkhKUF9UQUJMRSwgeyBUQUJMRV9TQUZFIGFzIFpISlBfVEFCTEVfU0FGRSB9IGZyb20gJy4vdGFibGUnO1xuaW1wb3J0IHsgX3JlX2Nqa19jb252IH0gZnJvbSAncmVnZXhwLWhlbHBlci9saWIvY2prLWNvbnYnO1xuXG5leHBvcnQgeyBaSEpQX1RBQkxFLCBaSEpQX1RBQkxFX1NBRkUgfTtcblxuZXhwb3J0IGNvbnN0IEtFWV9KUCA9ICdqcCc7XG5leHBvcnQgY29uc3QgS0VZX1pIVCA9ICd6aHQnO1xuZXhwb3J0IGNvbnN0IEtFWV9aSFMgPSAnemhzJztcblxuZXhwb3J0IHR5cGUgSUtFWV9GUk9NX1RPID0gdHlwZW9mIEtFWV9KUCB8IHR5cGVvZiBLRVlfWkhUIHwgdHlwZW9mIEtFWV9aSFMgfCAnanAnIHwgJ3podCcgfCAnemhzJztcblxubGV0IGluaXRlZCA9IGZhbHNlO1xuXG5leHBvcnQgbGV0IFRBQkxFOiBJVEFCTEVfTUFJTjtcblxuZXhwb3J0IGxldCBUQUJMRV9TQUZFOiBJVEFCTEVfTUFJTjtcblxuZXhwb3J0IGludGVyZmFjZSBJVEFCTEVfTUFJTlxue1xuXHRbS0VZX0pQXTogSVRBQkxFLFxuXHRbS0VZX1pIVF06IElUQUJMRSxcblx0W0tFWV9aSFNdOiBJVEFCTEUsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVRBQkxFXG57XG5cdFtrZXk6IHN0cmluZ106IElUQUJMRVNVQlxufVxuXG5leHBvcnQgaW50ZXJmYWNlIElUQUJMRVNVQlxue1xuXHRbS0VZX0pQXTogc3RyaW5nLFxuXHRbS0VZX1pIVF06IHN0cmluZyxcblx0W0tFWV9aSFNdOiBzdHJpbmcsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSU9wdGlvbnNcbntcblx0LyoqXG5cdCAqIOW/veeVpeeahOWtlyBvciDku7vkvZXmlK/mj7QgaW5kZXhPZiDnmoQgT2JqZWN0XG5cdCAqL1xuXHRza2lwPyxcblx0LyoqXG5cdCAqIHNhZmUgbW9kZVxuXHQgKi9cblx0c2FmZT86IGJvb2xlYW4sXG59XG5cbmV4cG9ydCBjb25zdCBkZWZhdWx0T3B0aW9uczogSU9wdGlvbnMgPSB7XG5cdHNhZmU6IHRydWUsXG59O1xuXG4vLyAvW1xcdTRFMDAtXFx1OUZGRlxcdXsyMDAwMH0tXFx1ezJGQTFGfV0rL3VcbmNvbnN0IFJFR0VYUF9URVNUID0gbmV3IFJlZ0V4cChfcmVfY2prX2NvbnYoJ3UnKS5zb3VyY2UgKyAnKycsICd1Jyk7XG5cbm5hbWVzcGFjZSBfXG57XG5cdGluaXQoKTtcblxuXHRleHBvcnQgbGV0IGpwMnpodDogSUZyb20yVG87XG5cdGV4cG9ydCBsZXQganAyemhzOiBJRnJvbTJUbztcblx0ZXhwb3J0IGxldCB6aHQyanA6IElGcm9tMlRvO1xuXHRleHBvcnQgbGV0IHpodDJ6aHM6IElGcm9tMlRvO1xuXHRleHBvcnQgbGV0IHpoczJqcDogSUZyb20yVG87XG5cdGV4cG9ydCBsZXQgemhzMnpodDogSUZyb20yVG87XG5cblx0bGV0IGxhbmdzID0gT2JqZWN0LmtleXMoVEFCTEUpO1xuXG5cdGxhbmdzLmZvckVhY2goZnVuY3Rpb24gKGZyb206IElLRVlfRlJPTV9UTylcblx0e1xuXHRcdGxhbmdzLmZvckVhY2goZnVuY3Rpb24gKHRvOiBJS0VZX0ZST01fVE8pXG5cdFx0e1xuXHRcdFx0aWYgKGZyb20gPT0gdG8pIHJldHVybjtcblxuXHRcdFx0X1tgJHtmcm9tfTIke3RvfWBdID0gZnVuY3Rpb24gKHN0ciwgb3B0aW9ucz86IElPcHRpb25zKTogc3RyaW5nXG5cdFx0XHR7XG5cdFx0XHRcdGlmICghUkVHRVhQX1RFU1QudGVzdChzdHIudG9TdHJpbmcoKSkpXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRyZXR1cm4gc3RyO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0b3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcblxuXHRcdFx0XHRyZXR1cm4gc3BsaXQoc3RyKVxuXHRcdFx0XHRcdC5tYXAoZnVuY3Rpb24gKGNoYXI6IHN0cmluZylcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRpZiAob3B0aW9ucy5za2lwICYmIG9wdGlvbnMuc2tpcC5pbmRleE9mKGNoYXIpICE9IC0xKVxuXHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gY2hhcjtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0bGV0IGM6IHN0cmluZztcblx0XHRcdFx0XHRcdGlmIChjID0gX2dldGRhdGEoY2hhciwgZnJvbSwgdG8sIG9wdGlvbnMuc2FmZSkpXG5cdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBjO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRyZXR1cm4gY2hhcjtcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdC5qb2luKCcnKVxuXHRcdFx0XHRcdDtcblx0XHRcdH0gYXMgSUZyb20yVG87XG5cdFx0fSk7XG5cdH0pO1xufVxuXG4vKipcbiAqIG9ubHkg5Y+q5bCHIOaXpeaWh+a8ouWtlyA9PiDovYnngrrnuYHmvKLlrZdcbiAqIEB0eXBlIHtJRnJvbTJUb31cbiAqL1xuZXhwb3J0IGNvbnN0IGpwMnpodCA9IF8uanAyemh0IGFzIElGcm9tMlRvO1xuLyoqXG4gKiBvbmx5IOWPquWwhyDml6XmlofmvKLlrZcgPT4g6L2J54K657Ch5ryi5a2XXG4gKiBAdHlwZSB7SUZyb20yVG99XG4gKi9cbmV4cG9ydCBjb25zdCBqcDJ6aHMgPSBfLmpwMnpocyBhcyBJRnJvbTJUbztcblxuLyoqXG4gKiBvbmx5IOewoea8ouWtlyA9PiDovYnngrrml6XmvKLlrZdcbiAqIEB0eXBlIHtJRnJvbTJUb31cbiAqL1xuZXhwb3J0IGNvbnN0IHpoczJqcCA9IF8uemhzMmpwO1xuXG4vKipcbiAqIG9ubHkg5Y+q5bCHIOe5gea8ouWtlyA9PiDovYnngrrml6XmlofmvKLlrZdcbiAqIEB0eXBlIHtJRnJvbTJUb31cbiAqL1xuZXhwb3J0IGNvbnN0IHpodDJqcCA9IF8uemh0MmpwO1xuXG4vKipcbiAqIG9ubHkg5Y+q5bCH57Ch57mB5pelIOeVtuS4reWFsemAmueahCDnuYHmvKLlrZcgPT4g6L2J54K657Ch5ryi5a2XXG4gKiDoq4vli7/kvZzngrrnsKHnuYHovYnmj5vnlKhcbiAqIEB0eXBlIHtJRnJvbTJUb31cbiAqL1xuZXhwb3J0IGNvbnN0IHpodDJ6aHMgPSBfLnpodDJ6aHM7XG5cbi8qKlxuICogb25seSDlj6rlsIfnsKHnuYHml6Ug55W25Lit5YWx6YCa55qEIOewoea8ouWtlyA9PiDovYnngrrnuYHmvKLlrZdcbiAqIOiri+WLv+S9nOeCuuewoee5gei9ieaPm+eUqFxuICogQHR5cGUge0lGcm9tMlRvfVxuICovXG5leHBvcnQgY29uc3QgemhzMnpodCA9IF8uemhzMnpodDtcblxuLyoqXG4gKiBvbmx5IOWPquWwh+ewoee5geaXpSDnlbbkuK3lhbHpgJrnmoQg57Ch57mB5ryi5a2XID0+IOi9ieeCuuaXpeaWh+a8ouWtl1xuICpcbiAqIEBhbGlhcyBjamsyanBcbiAqXG4gKiBAcGFyYW0gc3RyXG4gKiBAcGFyYW0ge0lPcHRpb25zfSBvcHRpb25zXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gemgyanAoc3RyLCBvcHRpb25zPzogSU9wdGlvbnMpOiBzdHJpbmdcbntcblx0aWYgKCFSRUdFWFBfVEVTVC50ZXN0KHN0ci50b1N0cmluZygpKSlcblx0e1xuXHRcdHJldHVybiBzdHI7XG5cdH1cblxuXHRvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdE9wdGlvbnMsIG9wdGlvbnMpO1xuXG5cdHJldHVybiBzcGxpdChzdHIpXG5cdFx0Lm1hcChmdW5jdGlvbiAoY2hhcjogc3RyaW5nKVxuXHRcdHtcblx0XHRcdGlmIChvcHRpb25zLnNraXAgJiYgb3B0aW9ucy5za2lwLmluZGV4T2YoY2hhcikgIT0gLTEpXG5cdFx0XHR7XG5cdFx0XHRcdHJldHVybiBjaGFyO1xuXHRcdFx0fVxuXG5cdFx0XHRsZXQgYzogc3RyaW5nO1xuXHRcdFx0aWYgKGMgPSBfZ2V0ZGF0YShjaGFyLCBLRVlfWkhULCBLRVlfSlAsIG9wdGlvbnMuc2FmZSkpXG5cdFx0XHR7XG5cdFx0XHRcdHJldHVybiBjO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSBpZiAoYyA9IF9nZXRkYXRhKGNoYXIsIEtFWV9aSFMsIEtFWV9KUCwgb3B0aW9ucy5zYWZlKSlcblx0XHRcdHtcblx0XHRcdFx0cmV0dXJuIGM7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBjaGFyO1xuXHRcdH0pXG5cdFx0LmpvaW4oJycpXG5cdFx0O1xufVxuXG4vKipcbiAqIG9ubHkg5Y+q5bCH57Ch57mB5pelIOeVtuS4reWFsemAmueahCDnsKHnuYHmvKLlrZcgPT4g6L2J54K65pel5paH5ryi5a2XXG4gKlxuICogQGFsaWFzIHpoMmpwXG4gKlxuICogQHBhcmFtIHN0clxuICogQHBhcmFtIHtJT3B0aW9uc30gb3B0aW9uc1xuICogQHJldHVybnMge3N0cmluZ31cbiAqL1xuZXhwb3J0IGNvbnN0IGNqazJqcCA9IHpoMmpwO1xuXG4vKipcbiAqIG9ubHkg5Y+q5bCH57Ch57mB5pelIOeVtuS4reWFsemAmueahCDmvKLlrZcgPT4g6L2J54K657mB6auU5ryi5a2XXG4gKiDoq4vli7/kvZzngrrnsKHnuYHovYnmj5vnlKhcbiAqXG4gKiBAcGFyYW0gc3RyXG4gKiBAcGFyYW0ge0lPcHRpb25zfSBvcHRpb25zXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2prMnpodChzdHIsIG9wdGlvbnM/OiBJT3B0aW9ucyk6IHN0cmluZ1xue1xuXHRpZiAoIVJFR0VYUF9URVNULnRlc3Qoc3RyLnRvU3RyaW5nKCkpKVxuXHR7XG5cdFx0cmV0dXJuIHN0cjtcblx0fVxuXG5cdG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG5cblx0cmV0dXJuIHNwbGl0KHN0cilcblx0XHQubWFwKGZ1bmN0aW9uIChjaGFyOiBzdHJpbmcpXG5cdFx0e1xuXHRcdFx0aWYgKG9wdGlvbnMuc2tpcCAmJiBvcHRpb25zLnNraXAuaW5kZXhPZihjaGFyKSAhPSAtMSlcblx0XHRcdHtcblx0XHRcdFx0cmV0dXJuIGNoYXI7XG5cdFx0XHR9XG5cblx0XHRcdGxldCBjOiBzdHJpbmc7XG5cdFx0XHRpZiAoYyA9IF9nZXRkYXRhKGNoYXIsIEtFWV9KUCwgS0VZX1pIVCwgb3B0aW9ucy5zYWZlKSlcblx0XHRcdHtcblx0XHRcdFx0cmV0dXJuIGM7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIGlmIChjID0gX2dldGRhdGEoY2hhciwgS0VZX1pIUywgS0VZX1pIVCwgb3B0aW9ucy5zYWZlKSlcblx0XHRcdHtcblx0XHRcdFx0cmV0dXJuIGM7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBjaGFyO1xuXHRcdH0pXG5cdFx0LmpvaW4oJycpXG5cdFx0O1xufVxuXG4vKipcbiAqIG9ubHkg5Y+q5bCH57Ch57mB5pelIOeVtuS4reWFsemAmueahCDmvKLlrZcgPT4g6L2J54K657Ch6auU5ryi5a2XXG4gKiDoq4vli7/kvZzngrrnsKHnuYHovYnmj5vnlKhcbiAqXG4gKiBAcGFyYW0gc3RyXG4gKiBAcGFyYW0ge0lPcHRpb25zfSBvcHRpb25zXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2prMnpocyhzdHIsIG9wdGlvbnM/OiBJT3B0aW9ucyk6IHN0cmluZ1xue1xuXHRpZiAoIVJFR0VYUF9URVNULnRlc3Qoc3RyLnRvU3RyaW5nKCkpKVxuXHR7XG5cdFx0cmV0dXJuIHN0cjtcblx0fVxuXG5cdG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG5cblx0cmV0dXJuIHNwbGl0KHN0cilcblx0XHQubWFwKGZ1bmN0aW9uIChjaGFyOiBzdHJpbmcpXG5cdFx0e1xuXHRcdFx0aWYgKG9wdGlvbnMuc2tpcCAmJiBvcHRpb25zLnNraXAuaW5kZXhPZihjaGFyKSAhPSAtMSlcblx0XHRcdHtcblx0XHRcdFx0cmV0dXJuIGNoYXI7XG5cdFx0XHR9XG5cblx0XHRcdGxldCBjOiBzdHJpbmc7XG5cdFx0XHRpZiAoYyA9IF9nZXRkYXRhKGNoYXIsIEtFWV9KUCwgS0VZX1pIUywgb3B0aW9ucy5zYWZlKSlcblx0XHRcdHtcblx0XHRcdFx0cmV0dXJuIGM7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIGlmIChjID0gX2dldGRhdGEoY2hhciwgS0VZX1pIVCwgS0VZX1pIUywgb3B0aW9ucy5zYWZlKSlcblx0XHRcdHtcblx0XHRcdFx0cmV0dXJuIGM7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBjaGFyO1xuXHRcdH0pXG5cdFx0LmpvaW4oJycpXG5cdFx0O1xufVxuXG4vL2ltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzLWV4dHJhJztcbi8vZnMub3V0cHV0SlNPTignLi90ZWFjaEthbmppQ29tcGFyaXNvbi5jYWNoZS5qc29uJywgVEFCTEUsIHtcbi8vXHRzcGFjZXM6IFwiXFx0XCIsXG4vL30pO1xuLy9mcy5vdXRwdXRKU09OKCcuL3RlYWNoS2FuamlDb21wYXJpc29uLmNhY2hlMi5qc29uJywgVEFCTEVfU0FGRSwge1xuLy9cdHNwYWNlczogXCJcXHRcIixcbi8vfSk7XG4vL1xuLy9jb25zb2xlLmxvZyh6aHMyanAoMSkpO1xuLy9cbi8vbGV0IHQgPSAn6a2U54mp6Kej6Kqs44CA44Op44Oz44Kv562J6Kmx44CA6JqA6J2V6J2V546L44Gn6Kem546LIOWGkumZuuiAheOCruODq+ODieino+iqrCDomoB86J2V5oiYfOaIpumprHzppqzkupp85Lqe5ZyL6aCQ5Lit5pel5ryi5a2X5bCN54Wn6KGoJ1xuLy9cbi8vY29uc29sZS5sb2coemgyanAodCkpO1xuLy9jb25zb2xlLmxvZyh6aHQyanAodCkpO1xuLy9jb25zb2xlLmxvZyh6aHMyanAodCkpO1xuLy9cbi8vY29uc29sZS5sb2coemh0Mnpocyh0KSk7XG4vL2NvbnNvbGUubG9nKHpoczJ6aHQodCkpO1xuXG5leHBvcnQgZnVuY3Rpb24gaW5pdChvdmVyd3JpdGU/OiBib29sZWFuKVxue1xuXHRpZiAoaW5pdGVkICYmICFvdmVyd3JpdGUpXG5cdHtcblx0XHRyZXR1cm4gVEFCTEU7XG5cdH1cblxuXHRUQUJMRSA9IF8oWkhKUF9UQUJMRSk7XG5cdFRBQkxFX1NBRkUgPSBfKFpISlBfVEFCTEVfU0FGRSk7XG5cblx0ZnVuY3Rpb24gXyhzcmMpOiBJVEFCTEVfTUFJTlxuXHR7XG5cdFx0bGV0IHRvID0ge307XG5cdFx0dG9bS0VZX0pQXSA9IHt9IGFzIElUQUJMRTtcblx0XHR0b1tLRVlfWkhUXSA9IHt9IGFzIElUQUJMRTtcblx0XHR0b1tLRVlfWkhTXSA9IHt9IGFzIElUQUJMRTtcblxuXHRcdHNyYy5mb3JFYWNoKGZ1bmN0aW9uICh2cm93OiBzdHJpbmdbXSlcblx0XHR7XG5cdFx0XHRsZXQgW2pwLCB6aHQsIHpoc10gPSB2cm93O1xuXG5cdFx0XHRsZXQgayA9IEtFWV9KUDtcblx0XHRcdGZvciAobGV0IGMgb2YganApXG5cdFx0XHR7XG5cdFx0XHRcdGlmICghYyB8fCB0b1trXVtjXSlcblx0XHRcdFx0e1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dG9ba11bY10gPSB0b1trXVtjXSB8fCB7fSBhcyBJVEFCTEVTVUI7XG5cblx0XHRcdFx0dG9ba11bY11ba10gPSBjO1xuXHRcdFx0XHR0b1trXVtjXVtLRVlfWkhUXSA9IHpodFswXTtcblx0XHRcdFx0dG9ba11bY11bS0VZX1pIU10gPSB6aHNbMF07XG5cdFx0XHR9XG5cblx0XHRcdGsgPSBLRVlfWkhUO1xuXHRcdFx0Zm9yIChsZXQgYyBvZiB6aHQpXG5cdFx0XHR7XG5cdFx0XHRcdGlmICghYyB8fCB0b1trXVtjXSlcblx0XHRcdFx0e1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dG9ba11bY10gPSB0b1trXVtjXSB8fCB7fSBhcyBJVEFCTEVTVUI7XG5cblx0XHRcdFx0dG9ba11bY11bS0VZX0pQXSA9IGpwWzBdO1xuXHRcdFx0XHR0b1trXVtjXVtrXSA9IGM7XG5cdFx0XHRcdHRvW2tdW2NdW0tFWV9aSFNdID0gemhzWzBdO1xuXHRcdFx0fVxuXG5cdFx0XHRrID0gS0VZX1pIUztcblx0XHRcdGZvciAobGV0IGMgb2YgemhzKVxuXHRcdFx0e1xuXHRcdFx0XHRpZiAoIWMgfHwgdG9ba11bY10pXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRvW2tdW2NdID0gdG9ba11bY10gfHwge30gYXMgSVRBQkxFU1VCO1xuXG5cdFx0XHRcdHRvW2tdW2NdW0tFWV9KUF0gPSBqcFswXTtcblx0XHRcdFx0dG9ba11bY11bS0VZX1pIVF0gPSB6aHRbMF07XG5cdFx0XHRcdHRvW2tdW2NdW2tdID0gYztcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIEB0cy1pZ25vcmVcblx0XHRyZXR1cm4gdG87XG5cdH1cblxuXHRpbml0ZWQgPSB0cnVlO1xuXG5cdHJldHVybiBUQUJMRTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9nZXRkYXRhKGNoYXI6IHN0cmluZywgZnJvbTogSUtFWV9GUk9NX1RPLCB0bzogSUtFWV9GUk9NX1RPLCBzYWZlPzogYm9vbGVhbik6IHN0cmluZ1xue1xuXHRpZiAoc2FmZSlcblx0e1xuXHRcdHJldHVybiAoVEFCTEVfU0FGRVtmcm9tXVtjaGFyXSkgPyBUQUJMRV9TQUZFW2Zyb21dW2NoYXJdW3RvXSA6IG51bGw7XG5cdH1cblxuXHRyZXR1cm4gKFRBQkxFW2Zyb21dW2NoYXJdKSA/IFRBQkxFW2Zyb21dW2NoYXJdW3RvXSA6IG51bGw7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUZyb20yVG8gZXh0ZW5kcyBGdW5jdGlvblxue1xuXHQoc3RyLCBvcHRpb25zPzogSU9wdGlvbnMpOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGV4cG9ydHMgYXMgdHlwZW9mIGltcG9ydCgnLi9jb3JlJyk7XG4iXX0=