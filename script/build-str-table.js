"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const strtable_1 = require("../lib/util/strtable");
const table_1 = require("../lib/zh/convert/table");
const min_1 = require("../lib/zh/convert/min");
const fs = require("fs-extra");
const path = require("path");
const table_plus_1 = require("../lib/zh/convert/table_plus");
let build_path = path.join(__dirname, '../build');
(async () => {
    await build('table_tw2cn', table_1.table_tw2cn, table_plus_1.table_tw2cn_plus);
    await new Promise(function (done) {
        setImmediate(done);
    });
    await build('table_cn2tw', table_1.table_cn2tw, table_plus_1.table_cn2tw_plus);
    await buildDebug('table_tw2cn', table_1.table_tw2cn, table_1.table_cn2tw, table_plus_1.table_tw2cn_plus);
    await buildDebug('table_cn2tw', table_1.table_cn2tw, table_1.table_tw2cn, table_plus_1.table_cn2tw_plus);
})();
async function buildDebug(name, table1, table2, table_plus) {
    let out = Object.entries(table1)
        .sort(function (a, b) {
        return a[0].codePointAt(0) - b[0].codePointAt(0);
    })
        .reduce(function (a, b) {
        let [from, to] = b;
        if (min_1.SAFE_MODE_CHAR_MIN.includes(from) || from !== table2[to] || table2[from] || (to in table1 && (table1[to] != from))) {
            a.unsafe[from] = to;
        }
        else {
            a.safe[from] = to;
        }
        return a;
    }, {
        safe: {},
        unsafe: {},
    });
    if (table_plus) {
        Object.assign(out.safe, table_plus);
    }
    let t1 = strtable_1.toStrTableArray(out.safe, {
        coreJs: true,
        ignore: true,
    });
    let t2 = strtable_1.toStrTableArray(out.safe);
    let path_out = path.join(build_path, 'zh/convert/');
    let ID = 'safe';
    return Promise.all([
        fs.outputFile(path.join(path_out, ID, `${name}.base.from.txt`), t1.from.join('')),
        fs.outputFile(path.join(path_out, ID, `${name}.base.to.txt`), t1.to.join('')),
        fs.outputFile(path.join(path_out, ID, `${name}.unicode.from.txt`), t2.from.join('')),
        fs.outputFile(path.join(path_out, ID, `${name}.unicode.to.txt`), t2.to.join('')),
        fs.outputJSON(path.join(path_out, `${name}.debug.json`), out, {
            spaces: "\t",
        })
    ]);
}
function build(name, table, table_plus) {
    let table2 = Object.entries(table)
        .reduce(function (a, b) {
        let [from, to] = b;
        a[from] = to;
        return a;
    }, {});
    if (table_plus) {
        Object.assign(table2, table_plus);
    }
    let t1 = strtable_1.toStrTableArray(table2, {
        coreJs: true,
        ignore: true,
    });
    let t2 = strtable_1.toStrTableArray(table2);
    console.log(`build: ${name}
table1 : ${Object.keys(table).length}
table2 : ${Object.keys(table2).length}
base   : ${t1.from.length}
unicode: ${t2.from.length}`);
    let path_out = path.join(build_path, 'zh/convert/');
    let ID = 'unsafe';
    return Promise.all([
        fs.outputJSON(path.join(path_out, `${name}.json`), table2, {
            spaces: "\t",
        }),
        fs.outputFile(path.join(path_out, ID, `${name}.base.from.txt`), t1.from.join('')),
        fs.outputFile(path.join(path_out, ID, `${name}.base.to.txt`), t1.to.join('')),
        fs.outputFile(path.join(path_out, ID, `${name}.unicode.from.txt`), t2.from.join('')),
        fs.outputFile(path.join(path_out, ID, `${name}.unicode.to.txt`), t2.to.join('')),
    ]);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVpbGQtc3RyLXRhYmxlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiYnVpbGQtc3RyLXRhYmxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsbURBQW1FO0FBQ25FLG1EQUFtRTtBQUNuRSwrQ0FBMkQ7QUFDM0QsK0JBQStCO0FBQy9CLDZCQUE2QjtBQUM3Qiw2REFBa0Y7QUFFbEYsSUFBSSxVQUFVLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsVUFBVSxDQUFDLENBQUM7QUFFbEQsQ0FBQyxLQUFLLElBQUksRUFBRTtJQUVYLE1BQU0sS0FBSyxDQUFDLGFBQWEsRUFBRSxtQkFBVyxFQUFFLDZCQUFnQixDQUFDLENBQUM7SUFFMUQsTUFBTSxJQUFJLE9BQU8sQ0FBQyxVQUFVLElBQUk7UUFFL0IsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BCLENBQUMsQ0FBQyxDQUFDO0lBRUgsTUFBTSxLQUFLLENBQUMsYUFBYSxFQUFFLG1CQUFXLEVBQUUsNkJBQWdCLENBQUMsQ0FBQztJQUUxRCxNQUFNLFVBQVUsQ0FBQyxhQUFhLEVBQUUsbUJBQVcsRUFBRSxtQkFBVyxFQUFFLDZCQUFnQixDQUFDLENBQUM7SUFDNUUsTUFBTSxVQUFVLENBQUMsYUFBYSxFQUFFLG1CQUFXLEVBQUUsbUJBQVcsRUFBRSw2QkFBZ0IsQ0FBQyxDQUFDO0FBQzdFLENBQUMsQ0FBQyxFQUFFLENBQUM7QUFFTCxLQUFLLFVBQVUsVUFBVSxDQUFDLElBQVksRUFBRSxNQUV2QyxFQUFFLE1BRUYsRUFBRSxVQUVGO0lBRUEsSUFBSSxHQUFHLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUM7U0FDOUIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUM7UUFFbkIsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FB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QUFJLENBQUMsUUFBUSxFQUFFLEVBQUUsRUFBRSxHQUFHLElBQUksY0FBYyxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDN0UsRUFBRSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxFQUFFLEVBQUUsR0FBRyxJQUFJLG1CQUFtQixDQUFDLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDcEYsRUFBRSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxFQUFFLEVBQUUsR0FBRyxJQUFJLGlCQUFpQixDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7S0FDaEYsQ0FBQyxDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHRvU3RyVGFibGUsIHRvU3RyVGFibGVBcnJheSB9IGZyb20gJy4uL2xpYi91dGlsL3N0cnRhYmxlJztcbmltcG9ydCB7IHRhYmxlX3R3MmNuLCB0YWJsZV9jbjJ0dyB9IGZyb20gJy4uL2xpYi96aC9jb252ZXJ0L3RhYmxlJztcbmltcG9ydCB7IFNBRkVfTU9ERV9DSEFSX01JTiB9IGZyb20gJy4uL2xpYi96aC9jb252ZXJ0L21pbic7XG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcy1leHRyYSc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHsgdGFibGVfY24ydHdfcGx1cywgdGFibGVfdHcyY25fcGx1cyB9IGZyb20gJy4uL2xpYi96aC9jb252ZXJ0L3RhYmxlX3BsdXMnO1xuXG5sZXQgYnVpbGRfcGF0aCA9IHBhdGguam9pbihfX2Rpcm5hbWUsICcuLi9idWlsZCcpO1xuXG4oYXN5bmMgKCkgPT5cbntcblx0YXdhaXQgYnVpbGQoJ3RhYmxlX3R3MmNuJywgdGFibGVfdHcyY24sIHRhYmxlX3R3MmNuX3BsdXMpO1xuXG5cdGF3YWl0IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChkb25lKVxuXHR7XG5cdFx0c2V0SW1tZWRpYXRlKGRvbmUpO1xuXHR9KTtcblxuXHRhd2FpdCBidWlsZCgndGFibGVfY24ydHcnLCB0YWJsZV9jbjJ0dywgdGFibGVfY24ydHdfcGx1cyk7XG5cblx0YXdhaXQgYnVpbGREZWJ1ZygndGFibGVfdHcyY24nLCB0YWJsZV90dzJjbiwgdGFibGVfY24ydHcsIHRhYmxlX3R3MmNuX3BsdXMpO1xuXHRhd2FpdCBidWlsZERlYnVnKCd0YWJsZV9jbjJ0dycsIHRhYmxlX2NuMnR3LCB0YWJsZV90dzJjbiwgdGFibGVfY24ydHdfcGx1cyk7XG59KSgpO1xuXG5hc3luYyBmdW5jdGlvbiBidWlsZERlYnVnKG5hbWU6IHN0cmluZywgdGFibGUxOiB7XG5cdFtrOiBzdHJpbmddOiBzdHJpbmcsXG59LCB0YWJsZTI6IHtcblx0W2s6IHN0cmluZ106IHN0cmluZyxcbn0sIHRhYmxlX3BsdXM/OiB7XG5cdFtrOiBzdHJpbmddOiBzdHJpbmcsXG59KVxue1xuXHRsZXQgb3V0ID0gT2JqZWN0LmVudHJpZXModGFibGUxKVxuXHRcdC5zb3J0KGZ1bmN0aW9uIChhLCBiKVxuXHRcdHtcblx0XHRcdHJldHVybiBhWzBdLmNvZGVQb2ludEF0KDApIC0gYlswXS5jb2RlUG9pbnRBdCgwKVxuXHRcdH0pXG5cdFx0LnJlZHVjZShmdW5jdGlvbiAoYSwgYilcblx0XHR7XG5cdFx0XHRsZXQgW2Zyb20sIHRvXSA9IGI7XG5cblx0XHRcdGlmIChTQUZFX01PREVfQ0hBUl9NSU4uaW5jbHVkZXMoZnJvbSkgfHwgZnJvbSAhPT0gdGFibGUyW3RvXSB8fCB0YWJsZTJbZnJvbV0gfHwgKHRvIGluIHRhYmxlMSAmJiAodGFibGUxW3RvXSAhPSBmcm9tKSkpXG5cdFx0XHR7XG5cdFx0XHRcdGEudW5zYWZlW2Zyb21dID0gdG87XG5cdFx0XHR9XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdGEuc2FmZVtmcm9tXSA9IHRvO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gYTtcblx0XHR9LCB7XG5cdFx0XHRzYWZlOiB7fSxcblx0XHRcdHVuc2FmZToge30sXG5cdFx0fSlcblx0O1xuXG5cdGlmICh0YWJsZV9wbHVzKVxuXHR7XG5cdFx0T2JqZWN0LmFzc2lnbihvdXQuc2FmZSwgdGFibGVfcGx1cyk7XG5cdH1cblxuXHRsZXQgdDEgPSB0b1N0clRhYmxlQXJyYXkob3V0LnNhZmUsIHtcblx0XHRjb3JlSnM6IHRydWUsXG5cdFx0aWdub3JlOiB0cnVlLFxuXHR9KTtcblxuXHRsZXQgdDIgPSB0b1N0clRhYmxlQXJyYXkob3V0LnNhZmUpO1xuXG5cdGxldCBwYXRoX291dCA9IHBhdGguam9pbihcblx0XHRidWlsZF9wYXRoLFxuXHRcdCd6aC9jb252ZXJ0LycsXG5cdCk7XG5cblx0bGV0IElEID0gJ3NhZmUnO1xuXG5cdHJldHVybiBQcm9taXNlLmFsbChbXG5cblx0XHRmcy5vdXRwdXRGaWxlKHBhdGguam9pbihwYXRoX291dCwgSUQsIGAke25hbWV9LmJhc2UuZnJvbS50eHRgKSwgdDEuZnJvbS5qb2luKCcnKSksXG5cdFx0ZnMub3V0cHV0RmlsZShwYXRoLmpvaW4ocGF0aF9vdXQsIElELCBgJHtuYW1lfS5iYXNlLnRvLnR4dGApLCB0MS50by5qb2luKCcnKSksXG5cblx0XHRmcy5vdXRwdXRGaWxlKHBhdGguam9pbihwYXRoX291dCwgSUQsIGAke25hbWV9LnVuaWNvZGUuZnJvbS50eHRgKSwgdDIuZnJvbS5qb2luKCcnKSksXG5cdFx0ZnMub3V0cHV0RmlsZShwYXRoLmpvaW4ocGF0aF9vdXQsIElELCBgJHtuYW1lfS51bmljb2RlLnRvLnR4dGApLCB0Mi50by5qb2luKCcnKSksXG5cblx0XHRmcy5vdXRwdXRKU09OKHBhdGguam9pbihwYXRoX291dCwgYCR7bmFtZX0uZGVidWcuanNvbmApLCBvdXQsIHtcblx0XHRcdHNwYWNlczogXCJcXHRcIixcblx0XHR9KVxuXHRdKTtcbn1cblxuZnVuY3Rpb24gYnVpbGQobmFtZTogc3RyaW5nLCB0YWJsZToge1xuXHRbazogc3RyaW5nXTogc3RyaW5nLFxufSwgdGFibGVfcGx1cz86IHtcblx0W2s6IHN0cmluZ106IHN0cmluZyxcbn0pXG57XG5cdGxldCB0YWJsZTIgPSBPYmplY3QuZW50cmllcyh0YWJsZSlcblx0XHQucmVkdWNlKGZ1bmN0aW9uIChhLCBiKVxuXHRcdHtcblx0XHRcdGxldCBbZnJvbSwgdG9dID0gYjtcblxuXHRcdFx0YVtmcm9tXSA9IHRvO1xuXG5cdFx0XHRyZXR1cm4gYTtcblx0XHR9LCB7fSlcblx0O1xuXG5cdGlmICh0YWJsZV9wbHVzKVxuXHR7XG5cdFx0T2JqZWN0LmFzc2lnbih0YWJsZTIsIHRhYmxlX3BsdXMpO1xuXHR9XG5cblx0bGV0IHQxID0gdG9TdHJUYWJsZUFycmF5KHRhYmxlMiwge1xuXHRcdGNvcmVKczogdHJ1ZSxcblx0XHRpZ25vcmU6IHRydWUsXG5cdH0pO1xuXG5cdGxldCB0MiA9IHRvU3RyVGFibGVBcnJheSh0YWJsZTIpO1xuXG5cdGNvbnNvbGUubG9nKGBidWlsZDogJHtuYW1lfVxudGFibGUxIDogJHtPYmplY3Qua2V5cyh0YWJsZSkubGVuZ3RofVxudGFibGUyIDogJHtPYmplY3Qua2V5cyh0YWJsZTIpLmxlbmd0aH1cbmJhc2UgICA6ICR7dDEuZnJvbS5sZW5ndGh9XG51bmljb2RlOiAke3QyLmZyb20ubGVuZ3RofWApO1xuXG5cdGxldCBwYXRoX291dCA9IHBhdGguam9pbihcblx0XHRidWlsZF9wYXRoLFxuXHRcdCd6aC9jb252ZXJ0LycsXG5cdCk7XG5cblx0bGV0IElEID0gJ3Vuc2FmZSc7XG5cblx0cmV0dXJuIFByb21pc2UuYWxsKFtcblx0XHRmcy5vdXRwdXRKU09OKHBhdGguam9pbihwYXRoX291dCwgYCR7bmFtZX0uanNvbmApLCB0YWJsZTIsIHtcblx0XHRcdHNwYWNlczogXCJcXHRcIixcblx0XHR9KSxcblx0XHRmcy5vdXRwdXRGaWxlKHBhdGguam9pbihwYXRoX291dCwgSUQsIGAke25hbWV9LmJhc2UuZnJvbS50eHRgKSwgdDEuZnJvbS5qb2luKCcnKSksXG5cdFx0ZnMub3V0cHV0RmlsZShwYXRoLmpvaW4ocGF0aF9vdXQsIElELCBgJHtuYW1lfS5iYXNlLnRvLnR4dGApLCB0MS50by5qb2luKCcnKSksXG5cdFx0ZnMub3V0cHV0RmlsZShwYXRoLmpvaW4ocGF0aF9vdXQsIElELCBgJHtuYW1lfS51bmljb2RlLmZyb20udHh0YCksIHQyLmZyb20uam9pbignJykpLFxuXHRcdGZzLm91dHB1dEZpbGUocGF0aC5qb2luKHBhdGhfb3V0LCBJRCwgYCR7bmFtZX0udW5pY29kZS50by50eHRgKSwgdDIudG8uam9pbignJykpLFxuXHRdKTtcbn1cbiJdfQ==